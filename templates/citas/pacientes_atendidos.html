{% extends "base.html" %}
{% load static %}

{% block title %}Pacientes Atendidos - {{ medico }}{% endblock %}

{% block extra_css %}
    <link rel="stylesheet" href="{% static 'css/citas/pacientes_atendidos.css' %}">
{% endblock %}

{% block content %}
<section class="card pacientes-lista">
  <h2>Pacientes Atendidos Hoy</h2>
  <p class="fecha-info">{{ fecha|date:"l, d \\d\\e F \\d\\e Y" }}</p>
  <p class="badge-contador">
    <strong>{{ citas_atendidas.count }}</strong> paciente{{ citas_atendidas.count|pluralize }}
  </p>

  {% if citas_atendidas %}
    <table class="table">
      <thead>
        <tr>
          <th>Paciente</th>
          <th>Edad</th>
          <th>CI</th>
          <th>Celular</th>
          <th>Duración</th>
          <th>Ecografía</th>
          <th>Atendido</th>
        </tr>
      </thead>
      <tbody>
        {% for cita in citas_atendidas %}
        <tr>
          <td><strong>{{ cita.paciente.nombres }} {{ cita.paciente.apellido_paterno }}</strong></td>
          <td>
            {% if cita.paciente.get_edad %}
              {{ cita.paciente.get_edad }} años
            {% else %}
              N/A
            {% endif %}
          </td>
          <td><code>{{ cita.paciente.ci }}</code></td>
          <td>{{ cita.paciente.celular|default:"N/A" }}</td>
          <td>
            <span class="badge badge-info">{{ cita.duracion_atencion_minutos|default:"—" }} min</span>
          </td>
          <td>
            {% if cita.requiere_ecografia %}
              <span class="badge badge-activo"><i class="fas fa-check"></i> Sí</span>
            {% else %}
              <span class="badge badge-muted"><i class="fas fa-times"></i> No</span>
            {% endif %}
          </td>
          <td><small>{{ cita.tiempo_fin_atencion|time:"H:i:s"|default:"—" }}</small></td>
        </tr>
        {% endfor %}
      </tbody>
    </table>
  {% else %}
    <tr><td colspan="7" style="text-align: center; padding: 20px; color: #999;">Sin pacientes atendidos hoy</td></tr>
  {% endif %}

  <!-- <p style="margin-top: 20px;">
    <a href="{% url 'citas:citas_hoy' %}" class="btn btn-secondary">
      <i class="fas fa-arrow-left"></i> Volver a Mis Citas
    </a>
  </p> -->
</section>

{% endblock %}

{% block extra_js %}
    <script src="{% static 'js/citas/pacientes_atendidos.js' %}"></script>
{% endblock %}
